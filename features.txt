VPS連線
ssh -i ~/.ssh/LightsailDefaultKey-us-west-2.pem ubuntu@35.93.161.252

VPS更新 / 安裝必要工具 / 設置防火牆
sudo apt update && sudo apt upgrade -y
    sudo apt install -y unzip git curl ufw
        sudo ufw allow OpenSSH
        sudo ufw allow 5000
        sudo ufw enable

VPS安裝Python 3.12.3
sudo apt install -y python3 python3-pip python3-venv
    python3 --version

#VPS ssh 配置
ssh -T git@github.com

#VPS GITHUB API 配置
curl -H "Authorization: token $GITHUB_TOKEN" https://api.github.com/user

#VPS下載 GitHub Repo
cd /path/to/your/directory
git clone git@github.com:ghsu998/ecommerce_analytics_db.git

#VPS創建Virtual Environment
mkdir ~/ecommerce_analytics_db
    cd ~/ecommerce_analytics_db
        python3 -m venv venv
            source venv/bin/activate
                pip install -r requirements.txt
                    pip freeze > requirements.txt
                        deactivate  # 確保退出虛擬環境
                            rm -rf venv

#VPS HTTPS配置
安裝 Nginx：
    sudo apt update
    sudo apt install nginx
安裝 Certbot 來生成 SSL 證書：
    sudo apt install certbot python3-certbot-nginx
配置 Nginx
    cd /etc/nginx/sites-available/
    sudo nano ecommerce.taigers.com


完整的指引，涵蓋如何檢查 VPS 上 Flask、Gunicorn、Nginx、Systemd 服務以及防火牆設置，確保你的 API 正常運行。



更新VPS JSON:
scp -i /Users/gary/.ssh/LightsailDefaultKey-us-west-2.pem /Users/gary/Documents/GitHub/ecommerce_analytics_db/config.json ubuntu@35.93.161.252:/home/ubuntu/ecommerce_analytics_db/config.json

更新github:
git add .
git commit -m "Update: api_ecommerce.py"
git push origin main

同步github:
git pull origin main

停止 Flask 進程：
pkill -f "flask"

重新啟動 Flask：
nohup python3 /path/to/your/flask/app.py > flask.log 2>&1 &




4️⃣ 設置開機自動啟動
sudo systemctl enable vps_github_api
檢查運行狀態
sudo systemctl status vps_github_api

#內部訪問API
#每次登入 VPS，快速檢查 Gunicorn 是否運行
ps aux | grep gunicorn

#確認 5000 端口是否監聽
sudo netstat -tulnp | grep 5000

#查看 nohup 日誌
cat gunicorn.log

#如果 Gunicorn 停止了，手動重新啟動
sudo pkill -f gunicorn
nohup gunicorn --workers 3 --bind 127.0.0.1:5000 api_ecommerce:app > gunicorn.log 2>&1 &
nohup gunicorn --workers 3 --bind 0.0.0.0:5000 api_ecommerce:app > gunicorn.log 2>&1 &

#檢查API接受外部訪問
curl -I http://35.93.161.252:5000

#